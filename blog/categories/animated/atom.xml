<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: animated | JavaScript Without Grammar]]></title>
  <link href="http://browniefed.com/blog/categories/animated/atom.xml" rel="self"/>
  <link href="http://browniefed.com/"/>
  <updated>2015-08-01T16:39:14-07:00</updated>
  <id>http://browniefed.com/</id>
  <author>
    <name><![CDATA[Jason Brown]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[React-native Animated API Basic Example]]></title>
    <link href="http://browniefed.com/blog/2015/07/26/react-native-animated-api-basic-example/"/>
    <updated>2015-07-26T11:51:00-07:00</updated>
    <id>http://browniefed.com/blog/2015/07/26/react-native-animated-api-basic-example</id>
    <content type="html"><![CDATA[<h1>Introduction</h1>

<p>Animations are finally solved in React? That&rsquo;s a bold claim, but lets explore the new Animated API in <code>react-native</code>. This won&rsquo;t apply to React for the web, however there is also <a href="https://github.com/chenglou/react-motion">react-motion</a> also released at <code>react-europe</code>.</p>

<p><img class="<a" src="href="http://i.imgur.com/JlX4nV0.gif">http://i.imgur.com/JlX4nV0.gif</a>" title="Final Animation Result" ></p>

<!-- more -->


<h1>Resources</h1>

<ul>
<li><a href="https://www.youtube.com/watch?v=1tavDv5hXpo">Cheng Lou &ndash; The State of Animation in React at react-europe 2015</a></li>
<li><a href="https://github.com/chenglou/react-motion">react-motion &ndash; Github</a></li>
<li><a href="https://facebook.github.io/react-native/docs/animations.html#content">React Native Animation API</a></li>
<li><a href="https://www.youtube.com/watch?v=xDlfrcM6YBk">Spencer Ahrens &ndash; React Native: Building Fluid User Experiences at react-europe 2015</a></li>
</ul>


<h1>How It Works</h1>

<p>The Animated API does not depend on calling <code>setState</code>, it is accomplished by calling <code>setNativeProps</code>. The Animated API exports a few components <code>Animated.View</code>, <code>Animated.Text</code>, and <code>Animated.Image</code>. The Animated API will adjust the components in the native Objective-C world. This will bypass the diff and reconciliation in the JS world so you get fluent, and performance animatons. Ultimately all you need to know is that it will interpolate numbers and update the native view components.</p>

<h1>Cool Examples</h1>

<ul>
<li><a href="https://github.com/brentvatne/react-native-animated-demo-tinder">https://github.com/brentvatne/react-native-animated-demo-tinder</a></li>
<li><a href="https://github.com/facebook/react-native/tree/master/Examples/UIExplorer/AnimationExample">UIExplorer Animated example</a></li>
</ul>


<h1>Simple Move Around the Screen Example</h1>

<p>We are just going to move a square around the edges of the screen.</p>

<p><code>
&lt;--&lt;           
|  |          
V--^         
</code></p>

<h1>Setup</h1>

<p>Dependencies</p>

<p>```
var React = require(&lsquo;react-native&rsquo;);
var Dimensions = require(&lsquo;Dimensions&rsquo;);</p>

<p>var {
  width,
  height
} = Dimensions.get(&lsquo;window&rsquo;);</p>

<p>var {
  AppRegistry,
  StyleSheet,
  View,
  Animated
} = React;</p>

<p>var SQUARE_DIMENSIONS = 30;</p>

<p>```</p>

<p>Styles</p>

<p>```
var styles = StyleSheet.create({
  container: {</p>

<pre><code>flex: 1
</code></pre>

<p>  },
  square: {</p>

<pre><code>width: SQUARE_DIMENSIONS,
height: SQUARE_DIMENSIONS,
backgroundColor: 'blue'
</code></pre>

<p>  }
});
```</p>

<p>Basic Code</p>

<p>```</p>

<p>var AnimatedSquare = React.createClass({
  getInitialState: function() {</p>

<pre><code>return {
    pan: new Animated.ValueXY()
};
</code></pre>

<p>  },
  getStyle: function() {</p>

<pre><code>return [
          styles.square, 
          {
            transform: this.state.pan.getTranslateTransform()
          }
        ];
</code></pre>

<p>  },
  render: function() {</p>

<pre><code>return (
  &lt;View style={styles.container}&gt;
    &lt;Animated.View style={this.getStyle()} /&gt;
  &lt;/View&gt;
);
</code></pre>

<p>  }
});
```</p>

<p>Few things to call out here.</p>

<p>Notice our state that is created is an instantiation of <code>Animated.ValueXY</code>. This will save us some code, and let the <code>Animated</code> API take care of interpolating both our X, and Y values.</p>

<p>Our <code>getStyle</code> will return an array, our base <code>square</code> class and a <code>transform</code>. Once again we&rsquo;ll use a the <code>getTranslateTransform</code> helper from the <code>Animated</code> API to return the appropriate structure for the transform style.</p>

<p>It returns <code>[{ translateX: xValue}, {translateY: yValue}]</code>, where <code>xValue</code> and <code>yValue</code> are the interpolated values from the <code>Animated.ValueXY</code> we set on our <code>pan</code> state variable.</p>

<p>Finally we will use the <code>Animated.View</code> which is a convenience element to say &ldquo;Hey React this is going to be an animated thing&rdquo;.</p>

<h1>Move It</h1>

<p>We&rsquo;re now going to move it from the top corner. <code>x = 0, y = 0</code> to the bottom left corner <code>x = 0, y = (phoneHeight - square Height)</code>.</p>

<p>```
var SPRING_CONFIG = {tension: 2, friction: 3}; //Soft spring</p>

<p>//&hellip;
  componentDidMount: function() {</p>

<pre><code>Animated.spring(this.state.pan, {
      ...SPRING_CONFIG,
      toValue: {x: 0, y: height - SQUARE_DIMENSIONS}                        // return to start
}).start();
</code></pre>

<p>  },
```</p>

<p>So on mount we&rsquo;ll start a spring. This will animate the <code>this.state.pan</code> to the bottom left corner like we want it to.</p>

<p>We&rsquo;ll also setup the <code>SPRING_CONFIG</code> with a soft spring, not much tension or friction. So it&rsquo;ll get to the corner and just bounce a little bit and stay there.</p>

<h1>Move It, Move It, and Move It again</h1>

<p>We can queue up sequences of animations. These will happen one after the other.
The <code>sequence</code> call is one of the means of composing animations. There is also <code>parallel</code> which allows for declaration of animations to happen at the same time.</p>

<p>```
  componentDidMount: function() {</p>

<pre><code>Animated.sequence([
  Animated.spring(this.state.pan, {
        ...SPRING_CONFIG,
        toValue: {x: 0, y: height - SQUARE_DIMENSIONS} //animate to bottom left
  }),
  Animated.spring(this.state.pan, {
      ...SPRING_CONFIG,
      toValue: {x: width - SQUARE_DIMENSIONS, y: height - SQUARE_DIMENSIONS} // animated to bottom right
  }),
  Animated.spring(this.state.pan, {
        ...SPRING_CONFIG,
        toValue: {x: width - SQUARE_DIMENSIONS, y: 0} //animate to top right
  }),
  Animated.spring(this.state.pan, {
      ...SPRING_CONFIG,
      toValue: {x: 0, y: 0} // return to start
  })
]).start();
</code></pre>

<p>  }
```</p>

<p>We define 4 spring configrations like discussed before. The comments in the code explain each movement.</p>

<h1>Move and Repeat</h1>

<p>The call to <code>start</code> takes a callback. This callback will be invoked once the animation is completed. In our case the animation is complete once we get back to the start. We can then restart the animation.</p>

<p>```
  componentDidMount: function() {</p>

<pre><code>this.startAndRepeat();
</code></pre>

<p>  },
  startAndRepeat: function() {</p>

<pre><code>this.triggerAnimation(this.startAndRepeat);
</code></pre>

<p>  },
  triggerAnimation: function(cb) {</p>

<pre><code>Animated.sequence([
  Animated.spring(this.state.pan, {
        ...SPRING_CONFIG,
        toValue: {x: 0, y: height - SQUARE_DIMENSIONS} //animate to bottom left
  }),
  Animated.spring(this.state.pan, {
      ...SPRING_CONFIG,
      toValue: {x: width - SQUARE_DIMENSIONS, y: height - SQUARE_DIMENSIONS} // animated to bottom right
  }),
  Animated.spring(this.state.pan, {
        ...SPRING_CONFIG,
        toValue: {x: width - SQUARE_DIMENSIONS, y: 0} //animate to top right
  }),
  Animated.spring(this.state.pan, {
      ...SPRING_CONFIG,
      toValue: {x: 0, y: 0} // return to start
  })
]).start(cb);
</code></pre>

<p>  }
```</p>

<p>We just make a call that triggers the animation and calls itself on complete.</p>

<h1>Full/Live Code</h1>

<h2><a href="https://rnplay.org/apps/QlPJ2Q">https://rnplay.org/apps/QlPJ2Q</a></h2>

<p>```
var React = require(&lsquo;react-native&rsquo;);
var Dimensions = require(&lsquo;Dimensions&rsquo;);</p>

<p>var {
  width,
  height
} = Dimensions.get(&lsquo;window&rsquo;);</p>

<p>var {
  AppRegistry,
  StyleSheet,
  View,
  Animated
} = React;</p>

<p>var SQUARE_DIMENSIONS = 30;
var SPRING_CONFIG = {tension: 2, friction: 3}; //Soft spring</p>

<p>var AnimatedSquare = React.createClass({
  getInitialState: function() {</p>

<pre><code>return {
    pan: new Animated.ValueXY()
};
</code></pre>

<p>  },
  componentDidMount: function() {</p>

<pre><code>this.startAndRepeat();
</code></pre>

<p>  },
  startAndRepeat: function() {</p>

<pre><code>this.triggerAnimation(this.startAndRepeat);
</code></pre>

<p>  },
  triggerAnimation: function(cb) {</p>

<pre><code>Animated.sequence([
  Animated.spring(this.state.pan, {
        ...SPRING_CONFIG,
        toValue: {x: 0, y: height - SQUARE_DIMENSIONS} //animate to bottom left
  }),
  Animated.spring(this.state.pan, {
      ...SPRING_CONFIG,
      toValue: {x: width - SQUARE_DIMENSIONS, y: height - SQUARE_DIMENSIONS} // animated to bottom right
  }),
  Animated.spring(this.state.pan, {
        ...SPRING_CONFIG,
        toValue: {x: width - SQUARE_DIMENSIONS, y: 0} //animate to top right
  }),
  Animated.spring(this.state.pan, {
      ...SPRING_CONFIG,
      toValue: {x: 0, y: 0} // return to start
  })
]).start(cb);
</code></pre>

<p>  },
  getStyle: function() {</p>

<pre><code>return [
          styles.square, 
          {
            transform: this.state.pan.getTranslateTransform()
          }
        ];
</code></pre>

<p>  },
  render: function() {</p>

<pre><code>return (
  &lt;View style={styles.container}&gt;
    &lt;Animated.View style={this.getStyle()} /&gt;
  &lt;/View&gt;
);
</code></pre>

<p>  }
});</p>

<p>var styles = StyleSheet.create({
  container: {</p>

<pre><code>flex: 1
</code></pre>

<p>  },
  square: {</p>

<pre><code>width: SQUARE_DIMENSIONS,
height: SQUARE_DIMENSIONS,
backgroundColor: 'blue'
</code></pre>

<p>  }
});</p>

<p>AppRegistry.registerComponent(&lsquo;AnimatedSquare&rsquo;, () => AnimatedSquare);</p>

<p>```</p>
]]></content>
  </entry>
  
</feed>
