
<!doctype html>
<!-- START OF _layouts/default.html -->
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible" >
		<meta content="width=device-width,initial-scale=1" name="viewport">
		<meta content="A blog of JavaScript techniques and tutorials. Including React, React Native, and anything else I feel like writing about." name="description">
		<meta content="JavaScript Without Grammar" name="author">


    
        <meta property="fb:app_id" content="1662675577336433" />
        <meta property="og:title" content="React Native Youtube Animated Video Slide" />
        <meta property="og:site_name" content="JavaScript Without Grammar" />
        <meta property="og:url" content="http://browniefed.com/blog/react-native-youtube-animated-video-slide/" />
        <meta property="og:description" content="" />
        
    

        
        <meta property="twitter:card" content="summary" />
        <meta property="twitter:site" content="browniefed" />
        <meta property="twitter:url" content="http://browniefed.com/blog/react-native-youtube-animated-video-slide/" />
        <meta property="twitter:title" content="React Native Youtube Animated Video Slide" />
        <meta property="twitter:description" content="" />
        <meta property="twitter:creator" content="browniefed" />
        
        


		
        <link rel='alternate' type='application/atom+xml' title='JavaScript Without Grammar' href='http://browniefed.com/atom.xml'>

		<title>React Native Youtube Animated Video Slide &mdash; JavaScript Without Grammar</title>
		
		<!-- Styles -->
		<link href="/stylesheets/main.css" rel="stylesheet">
		
		<!-- Google webfonts -->
		<link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Tangerine">
		<link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Cousine">
		
		<!-- jQuery and plugins -->
		<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
		<script type="text/javascript" src="/js/jquery.zclip.min.js"></script>

		<!-- Syntax highlighter -->
		<link href="/stylesheets/prettify-hemisu.css" type="text/css" rel="stylesheet" />
		<script type="text/javascript" src="/js/prettify.js"></script>
				
	</head>
	<body onload="prettyPrint()">
	
		<div class="wrap">
	
			<header>
				<div class="title"><a href="/">JavaScript Without Grammar</a></div>
								
								<div class="navi">
									<ul>
										<li><a href="/">Blog</a></li>
										<li><a href="/blog/archives">Archives</a></li>
										<li><a href="/about">About</a></li>
										<li><a href="http://github.com/browniefed">Github</a></li>
										<li><a href="http://twitter.com/browniefed">Twitter</a></li>
										<li><a href="mailto:browniefed@gmail.com">Email</a></li>
									<ul>
								</div> <!-- // .navi -->
			</header>
		
				<!-- START OF _layouts/post.html -->

<!-- START OF _includes/article.html -->
<article>
	<header>
		<h1><a href="/blog/react-native-youtube-animated-video-slide/">React Native Youtube Animated Video Slide</a></h1>
		<time>31 August 2015</time>
	</header>
	<div class="content">
		
            <div class="entry-content"><h1>Introduciton</h1>

<p>I was going to spend some time digging into <a href="https://github.com/ProjectSeptemberInc/gl-react-native">gl-react-native</a> when someone asked in the slack channel how to achieve youtube like video sliding navigation. Now I won&rsquo;t get into the navigation portion, just the animation part. The navigation portion can be solved by basically treating video routes as a modal. Thus they are always over the top of whatever the previous route was.</p>

<h1>What are we building?</h1>

<p>If you haven&rsquo;t seen it, YouTube allows you to drag the current playing video down to the bottom right corner and have it continue to play while you browse the rest of the app.</p>

<p>Something like this.</p>

<p><img src="http://i.imgur.com/gwbkw5f.gif" title="YouTube demo clone" ></p>

<!-- more -->


<h1>Setup</h1>

<p>React native doesn&rsquo;t have a <code>Video</code> component but Brent Vatne created a fantastic video component called <a href="https://github.com/brentvatne/react-native-video">react-native-video</a>. This allows you to use videos added to your app bundle, or external video urls.</p>

<p>So unlike a normal project you will need to run <code>npm install react-native-video --save</code>. Then follow the instructions on the <code>README</code> in <code>react-native-video</code> on how to add the library in XCode.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>var React = require('react-native');
</span><span class='line'>var Video = require('react-native-video');
</span><span class='line'>
</span><span class='line'>var Dimensions = require('Dimensions');
</span><span class='line'>var {width: deviceWidth, height: deviceHeight} = Dimensions.get('window');
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>var videoWidth = deviceWidth,
</span><span class='line'>    videoHeight = Math.round((deviceWidth/16)*9);
</span><span class='line'>
</span><span class='line'>var {
</span><span class='line'>  AppRegistry,
</span><span class='line'>  StyleSheet,
</span><span class='line'>  View,
</span><span class='line'>  Text,
</span><span class='line'>  Animated, 
</span><span class='line'>  PanResponder,
</span><span class='line'>  ScrollView
</span><span class='line'>} = React;
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>var AnimatedVideo = Animated.createAnimatedComponent(Video);
</span><span class='line'>var AnimatedScrollView = Animated.createAnimatedComponent(ScrollView);
</span></code></pre></td></tr></table></div></figure>


<p>So a few things to call out here.</p>

<p>We pull in dimensions of the screen and name them <code>deviceHeight</code> and <code>deviceWidth</code>. This is so we can calculate <code>videoWidth</code> and <code>videoHeight</code>. We use a simple calculation to create a video that is in the <code>16:9</code> aspect ratio.</p>

<p>Then we use <code>createAnimatedComponent</code> to create an animated <code>ScrollView</code> and <code>AnimatedVideo</code> element.</p>

<h1>Basic Component</h1>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>var YoutubeVideoSlide = React.createClass({
</span><span class='line'>  getInitialState: function() {
</span><span class='line'>    return {
</span><span class='line'>      scale: new Animated.Value(1),
</span><span class='line'>      position: new Animated.ValueXY(),
</span><span class='line'>    };
</span><span class='line'>  },
</span><span class='line'>  render: function() {
</span><span class='line'>    return (
</span><span class='line'>      &lt;View style={styles.container}&gt;
</span><span class='line'>              &lt;AnimatedVideo 
</span><span class='line'>                  source={{uri: "http://clips.vorwaerts-gmbh.de/big_buck_bunny.mp4"}}
</span><span class='line'>                  style={styles.videoSizing}
</span><span class='line'>                  rate={1}
</span><span class='line'>                  paused={false}
</span><span class='line'>                  volume={1}
</span><span class='line'>                  resizeMode={'stretch'}
</span><span class='line'>                  repeat={true} 
</span><span class='line'>              /&gt;
</span><span class='line'>            &lt;AnimatedScrollView style={styles.container}&gt;
</span><span class='line'>              &lt;View style={styles.comment}&gt;
</span><span class='line'>                &lt;Text&gt;Video Comment&lt;/Text&gt;
</span><span class='line'>              &lt;/View&gt;
</span><span class='line'>            &lt;/AnimatedScrollView&gt;
</span><span class='line'>      &lt;/View&gt;
</span><span class='line'>    );
</span><span class='line'>  }
</span><span class='line'>});
</span><span class='line'>
</span><span class='line'>var styles = StyleSheet.create({
</span><span class='line'>  container: {
</span><span class='line'>    flex: 1
</span><span class='line'>  },
</span><span class='line'>  videoSizing: {
</span><span class='line'>    width: videoWidth,
</span><span class='line'>    height: videoHeight
</span><span class='line'>  },
</span><span class='line'>  comment: {
</span><span class='line'>    height: 100
</span><span class='line'>  }
</span><span class='line'>});
</span></code></pre></td></tr></table></div></figure>


<p>We setup <code>flex:1</code> on the <code>View</code> so that the <code>ScrollView</code> will size correctly. We set the <code>width</code> and <code>height</code> on the <code>AnimatedVideo</code> to our <code>16:9</code> ratio. In the state we setup the initial scale to <code>1</code>, and an <code>X,Y</code> position for the moving video.</p>

<h1>Setup the PanResponder</h1>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>this._panResponder = PanResponder.create({
</span><span class='line'>  onStartShouldSetPanResponder: (evt, gestureState) =&gt; true,
</span><span class='line'>  onStartShouldSetPanResponderCapture: (evt, gestureState) =&gt; true,
</span><span class='line'>  onMoveShouldSetPanResponder: (evt, gestureState) =&gt; true,
</span><span class='line'>  onMoveShouldSetPanResponderCapture: (evt, gestureState) =&gt; true,
</span><span class='line'>  onPanResponderMove: Animated.event([
</span><span class='line'>      null, 
</span><span class='line'>      {
</span><span class='line'>          dy: this.state.position.y
</span><span class='line'>      }
</span><span class='line'>  ])
</span><span class='line'>});</span></code></pre></td></tr></table></div></figure>


<p>We&rsquo;ll do the normal &ldquo;say yes to allowing us to touch things&rdquo;, and then we&rsquo;ll setup an <code>Animated.event</code>. This is a helper function to traverse the arguments from <code>onPanResponderMove</code> and update an Animated value.</p>

<p><code>onPanResponderMove</code> gets called with an <code>event</code> as the first argument, and <code>gestureState</code> as the second. The <code>null</code> tells <code>Animated.event</code> to ignore the first argument, but to grab the <code>dy</code> from the <code>gestureState</code> and update the <code>y</code> value on our <code>Animated.ValueXY</code> we created.</p>

<h1>Interpolate and Animate</h1>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>this._scale = this.state.position.y.interpolate({
</span><span class='line'>  inputRange: [0, deviceHeight ],
</span><span class='line'>  outputRange: [1, .71],
</span><span class='line'>  extrapolate: 'clamp'
</span><span class='line'>});
</span><span class='line'>
</span><span class='line'>this._translateY = this.state.position.y.interpolate({
</span><span class='line'>  inputRange: [0, deviceHeight],
</span><span class='line'>  outputRange: [0, deviceHeight],
</span><span class='line'>  extrapolate: 'clamp'
</span><span class='line'>});
</span><span class='line'>
</span><span class='line'>this.state.position.y.addListener((value) =&gt; {
</span><span class='line'>  this._y = value.value;
</span><span class='line'>  var scaleValue = this._scale.__getAnimatedValue();
</span><span class='line'>  var currentVideoWidth = scaleValue * videoWidth;
</span><span class='line'>  var buffer = ((videoWidth - currentVideoWidth)/2);
</span><span class='line'>  this.state.position.x.setValue(buffer);
</span><span class='line'>}.bind(this));
</span><span class='line'>
</span><span class='line'>this._opacity = this.state.position.y.interpolate({
</span><span class='line'>  inputRange: [0, deviceHeight ],
</span><span class='line'>  outputRange: [1, .1]
</span><span class='line'>});</span></code></pre></td></tr></table></div></figure>


<p>Now we need to setup a few more things in the <code>componentWillMount</code>. The <code>this._scale</code> will be set on a scale transform. This is directly tied to the <code>y</code> position of us dragging. So we setup an interpolate, which goes from <code>0</code> to the <code>deviceHeight</code> and map that to an output range of <code>1</code> to <code>.71</code>. The <code>.71</code> was a trial and error number, I&rsquo;m sure there is math to calculate this but I guessed till I got it right.</p>

<p>The <code>clamp</code> is to say that this value cannot go above or below these values.</p>

<p>You may be wondering why we setup <code>translateY</code> when the <code>inputRange</code> and <code>outputRange</code> are exactly the same. The <code>clamp</code> is the key part. This means that if a user tries to slide the video up it will not grow in scale, or slide the video upwards. It can only go down.</p>

<p>We setup the listener so we can keep track of our <code>y</code> value, we&rsquo;ll get into that later. We&rsquo;ll use <code>__getAnimatedValue</code> to get the current scale. <strong>THIS WILL NOT WORK IN .11-rc</strong> and above. You cannot currently listen on interpolated values, and we need the interpolated value for our math.</p>

<p>We get the original <code>videoWidth</code> and multiply it times the scale value so we can get the current <code>videoWidth</code>. We subtract the <code>currentVideoWidth</code> from the <code>videoWidth</code> and divide it by <code>2</code> to get the current buffer. That buffer is the space between the right side of the video and the current scaled video. If we don&rsquo;t do this then the X/Y scaling on the video will just squish it to the middle of the screen. What we want to do is have it slide down the right side of the screen.</p>

<p>Finally we setup the opacity, this is for the <code>scrollView</code> to slowly fade as we swipe down.</p>

<h1>Setup the styling</h1>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>  getScalePosition: function() {
</span><span class='line'>    return {
</span><span class='line'>      transform: [
</span><span class='line'>        {scale: this._scale},
</span><span class='line'>        {translateX: this.state.position.x},
</span><span class='line'>        {translateY: this._translateY}
</span><span class='line'>      ]
</span><span class='line'>    }
</span><span class='line'>  },
</span><span class='line'>  getScrollOffset: function() {
</span><span class='line'>    return {
</span><span class='line'>      transform: [
</span><span class='line'>        {translateY: this._translateY},
</span><span class='line'>      ],
</span><span class='line'>      opacity: this._opacity
</span><span class='line'>    }
</span><span class='line'>  },
</span><span class='line'>
</span><span class='line'>    &lt;AnimatedVideo 
</span><span class='line'>      {...this._panResponder.panHandlers}
</span><span class='line'>      source=
</span><span class='line'>      style={[styles.videoSizing, this.getScalePosition()]}
</span><span class='line'>      rate={this.state.rate}
</span><span class='line'>      paused={this.state.paused}
</span><span class='line'>      volume={this.state.volume}
</span><span class='line'>      muted={this.state.muted}
</span><span class='line'>      resizeMode={this.state.resizeMode}
</span><span class='line'>      repeat={true}
</span><span class='line'>    /&gt;
</span><span class='line'>    &lt;AnimatedScrollView style={[styles.container, this.getScrollOffset()]}&gt;
</span><span class='line'>    &lt;/AnimatedScrollView&gt;</span></code></pre></td></tr></table></div></figure>


<p>Here we set default styling, and then make our calls to get the style objects with our animated values. For our video scale position we pass our <code>this._scale</code> to <code>scale</code> to transform both <code>scaleX</code>, and <code>scaleY</code>. We pass in our position x, and our <code>this._translateY</code> that is clamped.</p>

<p>For our <code>ScrollView</code> , we setup <code>translateY</code>, and pass in the opacity we created.</p>

<h1>Set Offset and Animate the Release</h1>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>this._panResponder = PanResponder.create({
</span><span class='line'>  onStartShouldSetPanResponder: (evt, gestureState) =&gt; true,
</span><span class='line'>  onStartShouldSetPanResponderCapture: (evt, gestureState) =&gt; true,
</span><span class='line'>  onMoveShouldSetPanResponder: (evt, gestureState) =&gt; true,
</span><span class='line'>  onMoveShouldSetPanResponderCapture: (evt, gestureState) =&gt; true,
</span><span class='line'>  onPanResponderGrant: function() {
</span><span class='line'>    this.state.position.y.setOffset(this._y)
</span><span class='line'>  }.bind(this),
</span><span class='line'>  onPanResponderMove: Animated.event([
</span><span class='line'>      null, 
</span><span class='line'>      {
</span><span class='line'>          dy: this.state.position.y
</span><span class='line'>      }
</span><span class='line'>  ]),
</span><span class='line'>  onPanResponderRelease: (e, gestureState) =&gt; {
</span><span class='line'>    this.state.position.flattenOffset();
</span><span class='line'>
</span><span class='line'>    if (gestureState.dy &gt;= 40) {
</span><span class='line'>      Animated.timing(this.state.position.y, {
</span><span class='line'>        duration: 200,
</span><span class='line'>        toValue: deviceHeight
</span><span class='line'>      }).start();
</span><span class='line'>    } else {
</span><span class='line'>      Animated.timing(this.state.position.y, {
</span><span class='line'>        duration: 200,
</span><span class='line'>        toValue: 0
</span><span class='line'>      }).start();
</span><span class='line'>    }
</span><span class='line'>
</span><span class='line'>  }.bind(this)
</span><span class='line'>});</span></code></pre></td></tr></table></div></figure>


<p>When I said we&rsquo;d get to why we kept track of the <code>y</code> this is why. This is so we can set the offset of the initial press and prevent the video from jumping. It will work for sliding down, but with <code>dy</code> it is always the delta. So on the slide up from the bottom it would immediately jump to the top, and we don&rsquo;t want that.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>  onPanResponderGrant: function() {
</span><span class='line'>    this.state.position.y.setOffset(this._y)
</span><span class='line'>  }.bind(this),</span></code></pre></td></tr></table></div></figure>


<p>This code sets the initial offset when you first touch to whatever the current y value is.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>  onPanResponderRelease: (e, gestureState) =&gt; {
</span><span class='line'>    this.state.position.flattenOffset();
</span><span class='line'>
</span><span class='line'>    if (gestureState.dy &gt;= 100) {
</span><span class='line'>      Animated.timing(this.state.position.y, {
</span><span class='line'>        duration: 200,
</span><span class='line'>        toValue: deviceHeight
</span><span class='line'>      }).start();
</span><span class='line'>    } else {
</span><span class='line'>      Animated.timing(this.state.position.y, {
</span><span class='line'>        duration: 200,
</span><span class='line'>        toValue: 0
</span><span class='line'>      }).start();
</span><span class='line'>    }
</span><span class='line'>
</span><span class='line'>  }.bind(this)</span></code></pre></td></tr></table></div></figure>


<p>On release we flatten the offset. Which just squashes the current value and offset together.
If the user has moved greater than <code>100</code> pixels then we&rsquo;ll animate the video to the bottom of the screen. If not we&rsquo;ll animate it back to the top.</p>

<h1>Final</h1>

<p>As always check it out on RNPlay at <a href="https://rnplay.org/apps/Cp_SSA">https://rnplay.org/apps/Cp_SSA</a>.
The video source comes from <a href="http://camendesign.com/code/video_for_everybody/test.html">http://camendesign.com/code/video_for_everybody/test.html</a>. It&rsquo;s a wonderfully open sourced mp4 video that we can link to test out.</p>

<h1>Full Code</h1>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
<span class='line-number'>140</span>
<span class='line-number'>141</span>
<span class='line-number'>142</span>
<span class='line-number'>143</span>
<span class='line-number'>144</span>
<span class='line-number'>145</span>
<span class='line-number'>146</span>
<span class='line-number'>147</span>
<span class='line-number'>148</span>
<span class='line-number'>149</span>
<span class='line-number'>150</span>
<span class='line-number'>151</span>
<span class='line-number'>152</span>
<span class='line-number'>153</span>
<span class='line-number'>154</span>
<span class='line-number'>155</span>
<span class='line-number'>156</span>
<span class='line-number'>157</span>
<span class='line-number'>158</span>
<span class='line-number'>159</span>
<span class='line-number'>160</span>
<span class='line-number'>161</span>
<span class='line-number'>162</span>
<span class='line-number'>163</span>
<span class='line-number'>164</span>
<span class='line-number'>165</span>
<span class='line-number'>166</span>
<span class='line-number'>167</span>
<span class='line-number'>168</span>
<span class='line-number'>169</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>var React = require('react-native');
</span><span class='line'>var Dimensions = require('Dimensions');
</span><span class='line'>var {width: deviceWidth, height: deviceHeight} = Dimensions.get('window');
</span><span class='line'>var Video = require('react-native-video');
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>var videoWidth = deviceWidth,
</span><span class='line'>    videoHeight = Math.round((deviceWidth/16)*9);
</span><span class='line'>
</span><span class='line'>var {
</span><span class='line'>  AppRegistry,
</span><span class='line'>  StyleSheet,
</span><span class='line'>  View,
</span><span class='line'>  Text,
</span><span class='line'>  Animated, 
</span><span class='line'>  PanResponder,
</span><span class='line'>  ScrollView
</span><span class='line'>} = React;
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>var AnimatedVideo = Animated.createAnimatedComponent(Video);
</span><span class='line'>var AnimatedScrollView = Animated.createAnimatedComponent(ScrollView);
</span><span class='line'>
</span><span class='line'>var YoutubeVideoSlide = React.createClass({
</span><span class='line'>  getInitialState: function() {
</span><span class='line'>    return {
</span><span class='line'>      rate: 1,
</span><span class='line'>      volume: 1,
</span><span class='line'>      muted: true,
</span><span class='line'>      resizeMode: 'stretch',
</span><span class='line'>      duration: 0.0,
</span><span class='line'>      currentTime: 0.0,
</span><span class='line'>      scale: new Animated.Value(1),
</span><span class='line'>      position: new Animated.ValueXY(),
</span><span class='line'>
</span><span class='line'>    };
</span><span class='line'>  },
</span><span class='line'>  _y: 0,
</span><span class='line'>  componentWillMount: function() {
</span><span class='line'>    this._panResponder = PanResponder.create({
</span><span class='line'>      onStartShouldSetPanResponder: (evt, gestureState) =&gt; true,
</span><span class='line'>      onStartShouldSetPanResponderCapture: (evt, gestureState) =&gt; true,
</span><span class='line'>      onMoveShouldSetPanResponder: (evt, gestureState) =&gt; true,
</span><span class='line'>      onMoveShouldSetPanResponderCapture: (evt, gestureState) =&gt; true,
</span><span class='line'>      onPanResponderGrant: function() {
</span><span class='line'>        this.state.position.y.setOffset(this._y)
</span><span class='line'>      }.bind(this),
</span><span class='line'>      onPanResponderMove: Animated.event([
</span><span class='line'>          null, 
</span><span class='line'>          {
</span><span class='line'>              dy: this.state.position.y
</span><span class='line'>          }
</span><span class='line'>      ]),
</span><span class='line'>      onPanResponderRelease: (e, gestureState) =&gt; {
</span><span class='line'>        this.state.position.flattenOffset();
</span><span class='line'>
</span><span class='line'>        if (gestureState.dy &gt;= 100) {
</span><span class='line'>          Animated.timing(this.state.position.y, {
</span><span class='line'>            duration: 200,
</span><span class='line'>            toValue: deviceHeight
</span><span class='line'>          }).start();
</span><span class='line'>        } else {
</span><span class='line'>          Animated.timing(this.state.position.y, {
</span><span class='line'>            duration: 200,
</span><span class='line'>            toValue: 0
</span><span class='line'>          }).start();
</span><span class='line'>        }
</span><span class='line'>
</span><span class='line'>      }.bind(this)
</span><span class='line'>    });
</span><span class='line'>
</span><span class='line'>    this._scale = this.state.position.y.interpolate({
</span><span class='line'>      inputRange: [0, deviceHeight ],
</span><span class='line'>      outputRange: [1, .71],
</span><span class='line'>      extrapolate: 'clamp'
</span><span class='line'>    });
</span><span class='line'>
</span><span class='line'>    this._translateY = this.state.position.y.interpolate({
</span><span class='line'>      inputRange: [0, deviceHeight],
</span><span class='line'>      outputRange: [0, deviceHeight],
</span><span class='line'>      extrapolate: 'clamp'
</span><span class='line'>    });
</span><span class='line'>
</span><span class='line'>    this.state.position.y.addListener((value) =&gt; {
</span><span class='line'>      this._y = value.value;
</span><span class='line'>      var scaleValue = this._scale.__getAnimatedValue();
</span><span class='line'>      var currentVideoWidth = scaleValue * videoWidth;
</span><span class='line'>      var buffer = ((videoWidth - currentVideoWidth)/2);
</span><span class='line'>      this.state.position.x.setValue(buffer);
</span><span class='line'>    }.bind(this));
</span><span class='line'>
</span><span class='line'>    this._opacity = this.state.position.y.interpolate({
</span><span class='line'>      inputRange: [0, deviceHeight ],
</span><span class='line'>      outputRange: [1, .1]
</span><span class='line'>    });
</span><span class='line'>
</span><span class='line'>  },
</span><span class='line'>  getScalePosition: function() {
</span><span class='line'>    return {
</span><span class='line'>      transform: [
</span><span class='line'>        {scale: this._scale},
</span><span class='line'>        {translateX: this.state.position.x},
</span><span class='line'>        {translateY: this._translateY}
</span><span class='line'>      ]
</span><span class='line'>    }
</span><span class='line'>  },
</span><span class='line'>  getScrollOffset: function() {
</span><span class='line'>    return {
</span><span class='line'>      transform: [
</span><span class='line'>        {translateY: this._translateY},
</span><span class='line'>      ],
</span><span class='line'>      opacity: this._opacity
</span><span class='line'>    }
</span><span class='line'>  },
</span><span class='line'>  render: function() {
</span><span class='line'>    return (
</span><span class='line'>      &lt;View style={styles.container}&gt;
</span><span class='line'>              &lt;AnimatedVideo 
</span><span class='line'>                  {...this._panResponder.panHandlers}
</span><span class='line'>                  source={{uri: "http://clips.vorwaerts-gmbh.de/big_buck_bunny.mp4"}}
</span><span class='line'>                  style={[styles.videoSizing, this.getScalePosition()]}
</span><span class='line'>                  rate={this.state.rate}
</span><span class='line'>                  paused={this.state.paused}
</span><span class='line'>                  volume={this.state.volume}
</span><span class='line'>                  muted={this.state.muted}
</span><span class='line'>                  resizeMode={this.state.resizeMode}
</span><span class='line'>                  repeat={true} 
</span><span class='line'>              /&gt;
</span><span class='line'>            &lt;AnimatedScrollView style={[styles.container, this.getScrollOffset()]}&gt;
</span><span class='line'>              &lt;View style={styles.comment}&gt;
</span><span class='line'>                &lt;Text&gt;Video Comment&lt;/Text&gt;
</span><span class='line'>              &lt;/View&gt;
</span><span class='line'>              &lt;View style={styles.comment}&gt;
</span><span class='line'>                &lt;Text&gt;Video Comment&lt;/Text&gt;
</span><span class='line'>              &lt;/View&gt;
</span><span class='line'>              &lt;View style={styles.comment}&gt;
</span><span class='line'>                &lt;Text&gt;Video Comment&lt;/Text&gt;
</span><span class='line'>              &lt;/View&gt;
</span><span class='line'>              &lt;View style={styles.comment}&gt;
</span><span class='line'>                &lt;Text&gt;Video Comment&lt;/Text&gt;
</span><span class='line'>              &lt;/View&gt;
</span><span class='line'>              &lt;View style={styles.comment}&gt;
</span><span class='line'>                &lt;Text&gt;Video Comment&lt;/Text&gt;
</span><span class='line'>              &lt;/View&gt;
</span><span class='line'>              &lt;View style={styles.comment}&gt;
</span><span class='line'>                &lt;Text&gt;Video Comment&lt;/Text&gt;
</span><span class='line'>              &lt;/View&gt;
</span><span class='line'>              &lt;View style={styles.comment}&gt;
</span><span class='line'>                &lt;Text&gt;Video Comment&lt;/Text&gt;
</span><span class='line'>              &lt;/View&gt;
</span><span class='line'>            &lt;/AnimatedScrollView&gt;
</span><span class='line'>      &lt;/View&gt;
</span><span class='line'>    );
</span><span class='line'>  }
</span><span class='line'>});
</span><span class='line'>
</span><span class='line'>var styles = StyleSheet.create({
</span><span class='line'>  container: {
</span><span class='line'>    flex: 1
</span><span class='line'>  },
</span><span class='line'>  videoSizing: {
</span><span class='line'>    width: videoWidth,
</span><span class='line'>    height: videoHeight
</span><span class='line'>  },
</span><span class='line'>  comment: {
</span><span class='line'>    height: 100
</span><span class='line'>  }
</span><span class='line'>});
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>



</div>
        
	</div>
	<div>
    	


		



  
		
			Tagged under
		
    <a class='category' href='/blog/categories/animated/'>animated</a>, <a class='category' href='/blog/categories/animation/'>animation</a>, <a class='category' href='/blog/categories/native/'>native</a>, <a class='category' href='/blog/categories/react/'>react</a>, <a class='category' href='/blog/categories/react-native/'>react-native</a>, <a class='category' href='/blog/categories/slider/'>slider</a>, <a class='category' href='/blog/categories/video/'>video</a>, <a class='category' href='/blog/categories/youtube/'>youtube</a>
	


    	
	</div>
	
</article>
<!-- END OF _includes/article.html -->


<footer style="margin-top: 10px;">
    <div id="post-author">
	<div class="post-author-content" style="width: 70%; display: inline-block;">
		<p style="font-size: 16px;">
			If you ever want further explanation, want to see a particular type of tutorial, or to contact me for whatever reason you can drop me a line on twitter <a href="http://twitter.com/browniefed">@browniefed</a> or email me at <a href="mailto:browniefed@gmail.com">browniefed@gmail.com</a>
		</p>
	</div>
</div>
</footer>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>


<!-- END OF _/layouts/post.html -->

		
			<footer>
				Copyright &copy; 2017

	Jason Brown


			</footer>
			
		</div> <!-- // .wrap -->
          

<script type="text/javascript">
      var disqus_shortname = 'browniefedblog';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://browniefed.com/blog/react-native-youtube-animated-video-slide/';
        var disqus_url = 'http://browniefed.com/blog/react-native-youtube-animated-video-slide/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	</body>
	<script>
		$(document).ready(function() {
			// Make images center
			$('p:has(img)').css('text-align', 'center');
			
			// Add the image's title attribute as a caption
			$('p:has(img)').append(function () {
				return '<div class="caption">' + $('img', this).attr('title') + '</div>';
			});
			
			// Prettify code
			$('code').addClass('prettyprint');
			$('pre code').addClass('linenums');
			
			// Copy to clipboard with button
			$('pre:has(code)').prepend(function(){
				return '<div class="clip-btn">copy to clipboard</div>';
			});
			$('.clip-btn').zclip({
				path:'/js/ZeroClipboard.swf',
				copy: function() {
                    return $(this).next('code').text().split("\n").join("\r\n")
                },
				afterCopy: function(){
					$(this).replaceWith('<div class="clip-btn">copied!');
				}
			});
		});
	</script>
    

<script type="text/javascript">
      var disqus_shortname = 'browniefedblog';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://browniefed.com/blog/react-native-youtube-animated-video-slide/';
        var disqus_url = 'http://browniefed.com/blog/react-native-youtube-animated-video-slide/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


</html>
<!-- END OF _layouts/default.html -->
