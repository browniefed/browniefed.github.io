
<!doctype html>
<!-- START OF _layouts/default.html -->
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible" >
		<meta content="width=device-width,initial-scale=1" name="viewport">
		<meta content="A blog of JavaScript techniques and tutorials. Including React, React Native, and anything else I feel like writing about." name="description">
		<meta content="JavaScript Without Grammar" name="author">


    
        <meta property="fb:app_id" content="1662675577336433" />
        <meta property="og:title" content="React Native - How to create Twitter exploding hearts" />
        <meta property="og:site_name" content="JavaScript Without Grammar" />
        <meta property="og:url" content="http://browniefed.com/blog/react-native-how-to-create-twitter-exploding-hearts/" />
        <meta property="og:description" content="" />
        <meta property="og:image" content="http://i.imgur.com/4OrRx7Y.png" />
    

        
        <meta property="twitter:card" content="summary_large_image" />
        <meta property="twitter:site" content="browniefed" />
        <meta property="twitter:url" content="http://browniefed.com/blog/react-native-how-to-create-twitter-exploding-hearts/" />
        <meta property="twitter:title" content="React Native - How to create Twitter exploding hearts" />
        <meta property="twitter:description" content="" />
        <meta property="twitter:creator" content="browniefed" />
        <meta property="twitter:image:src" content="http://i.imgur.com/4OrRx7Y.png" />
        


		
        <link rel='alternate' type='application/atom+xml' title='JavaScript Without Grammar' href='http://browniefed.com/atom.xml'>

		<title>React Native - How to create Twitter exploding hearts &mdash; JavaScript Without Grammar</title>
		
		<!-- Styles -->
		<link href="/stylesheets/main.css" rel="stylesheet">
		
		<!-- Google webfonts -->
		<link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Tangerine">
		<link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Cousine">
		
		<!-- jQuery and plugins -->
		<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
		<script type="text/javascript" src="/js/jquery.zclip.min.js"></script>

		<!-- Syntax highlighter -->
		<link href="/stylesheets/prettify-hemisu.css" type="text/css" rel="stylesheet" />
		<script type="text/javascript" src="/js/prettify.js"></script>
				
	</head>
	<body onload="prettyPrint()">
	
		<div class="wrap">
	
			<header>
				<div class="title"><a href="/">JavaScript Without Grammar</a></div>
								
								<div class="navi">
									<ul>
										<li><a href="/">Blog</a></li>
										<li><a href="/blog/archives">Archives</a></li>
										<li><a href="/about">About</a></li>
										<li><a href="http://github.com/browniefed">Github</a></li>
										<li><a href="http://twitter.com/browniefed">Twitter</a></li>
										<li><a href="mailto:browniefed@gmail.com">Email</a></li>
									<ul>
								</div> <!-- // .navi -->
			</header>
		
				<!-- START OF _layouts/post.html -->

<!-- START OF _includes/article.html -->
<article>
	<header>
		<h1><a href="/blog/react-native-how-to-create-twitter-exploding-hearts/">React Native - How to create Twitter exploding hearts</a></h1>
		<time>07 November 2015</time>
	</header>
	<div class="content">
		
            <div class="entry-content"><p>So we&rsquo;re going to build this exploding heart, except just know Twitter kind of cheated. Not really but they used an image and played each frame adjusting <code>background-position</code> so it looked animated. Okay not cheated they used a really smart technique but what&rsquo;s the fun in doing that when we can build it for real!</p>

<p>I&rsquo;ve already built a Firework concept here <a href="http://browniefed.com/blog/2015/08/29/react-native-animated-with-react-art-firework-show/">http://browniefed.com/blog/2015/08/29/react-native-animated-with-react-art-firework-show/</a> and about Hearts here <a href="http://browniefed.com/blog/2015/09/07/react-native-periscope-hearts-animation/">http://browniefed.com/blog/2015/09/07/react-native-periscope-hearts-animation/</a> now we just need to bring them together.</p>

<p>For the record this is what theirs looks like here <a href="http://i.imgur.com/3a8PiSY.png">http://i.imgur.com/3a8PiSY.png</a></p>

<h2>What are we building</h2>

<p><img src="http://i.imgur.com/lMOxqIL.gif" title="So not lazy like Twitter" ></p>

<!-- more -->


<h2>Concept</h2>

<p>Rather than iterating over 28 separate image frames what we&rsquo;re going to do instead is make some pseudo-keyframe-animations. We&rsquo;ll use <code>Animated</code> of course. We&rsquo;ll define our range from <code>0</code> to <code>28</code>. Meaning we&rsquo;ll have 28 frames to deal with.</p>

<p>This makes the math easy, because we can walk through each frame, and describe what the animation should look like for each frame.</p>

<p>We could create separate animated values for each property and coordinate the animation with <code>Animated.sequence</code> and <code>Animated.parallel</code> but I prefer interpolation. YMMV</p>

<h2>Setup</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>var React = require('react-native');
</span><span class='line'>
</span><span class='line'>var {
</span><span class='line'>  AppRegistry,
</span><span class='line'>  StyleSheet,
</span><span class='line'>  View,
</span><span class='line'>  Dimensions,
</span><span class='line'>  TouchableWithoutFeedback,
</span><span class='line'>  Animated
</span><span class='line'>} = React;
</span><span class='line'>
</span><span class='line'>var Art = require('ReactNativeART');
</span><span class='line'>
</span><span class='line'>var {
</span><span class='line'>  Surface,
</span><span class='line'>  Group,
</span><span class='line'>  Shape,
</span><span class='line'>  Path
</span><span class='line'>} = Art;
</span><span class='line'>
</span><span class='line'>var AnimatedShape = Animated.createAnimatedComponent(Shape);
</span><span class='line'>
</span><span class='line'>var {
</span><span class='line'>  width: deviceWidth,
</span><span class='line'>  height: deviceHeight
</span><span class='line'>} = Dimensions.get('window');
</span></code></pre></td></tr></table></div></figure>


<p>We&rsquo;ll need to setup <code>ReactNativeArt</code> in XCode, you can check out how to do that <a href="http://browniefed.com/blog/2015/05/03/getting-react-art-running-on-react-native/">here</a>.</p>

<p>Things to call out here is we are creating a custom animated view, called <code>AnimatedShape</code>. We pass in the <code>art</code> <code>Shape</code> component into <code>Animated.createAnimatedComponent</code>. This allows us to use <code>Animated</code> values in any component.</p>

<h2>More Setup</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>var HEART_SVG = "M130.4-0.8c25.4 0 46 20.6 46 46.1 0 13.1-5.5 24.9-14.2 33.3L88 153.6 12.5 77.3c-7.9-8.3-12.8-19.6-12.8-31.9 0-25.5 20.6-46.1 46-46.2 19.1 0 35.5 11.7 42.4 28.4C94.9 11 111.3-0.8 130.4-0.8"
</span><span class='line'>var HEART_COLOR = 'rgb(226,38,77,1)';
</span><span class='line'>var GRAY_HEART_COLOR = "rgb(204,204,204,1)";
</span><span class='line'>
</span><span class='line'>var FILL_COLORS = [
</span><span class='line'>  'rgba(221,70,136,1)',
</span><span class='line'>  'rgba(212,106,191,1)',
</span><span class='line'>  'rgba(204,142,245,1)',
</span><span class='line'>  'rgba(204,142,245,1)',
</span><span class='line'>  'rgba(204,142,245,1)',
</span><span class='line'>  'rgba(0,0,0,0)'
</span><span class='line'>];
</span><span class='line'>
</span><span class='line'>var PARTICLE_COLORS = [
</span><span class='line'>  'rgb(158, 202, 250)',
</span><span class='line'>  'rgb(161, 235, 206)',
</span><span class='line'>  'rgb(208, 148, 246)',
</span><span class='line'>  'rgb(244, 141, 166)',
</span><span class='line'>  'rgb(234, 171, 104)',
</span><span class='line'>  'rgb(170, 163, 186)'
</span><span class='line'>]</span></code></pre></td></tr></table></div></figure>


<p>More setup here. We create our heart SVG path to render, and setup a bunch of colors that we will use in our animations later. We need to set stuff up as <code>rgb</code> or <code>rgba</code> so that <code>Animated</code> can interpolate it correctly as at the moment it cannot do hex values.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>function getXYParticle(total, i, radius) {
</span><span class='line'>  var angle = ( (2*Math.PI) / total ) * i;
</span><span class='line'>
</span><span class='line'>  var x = Math.round((radius*2) * Math.cos(angle - (Math.PI/2)));
</span><span class='line'>  var y = Math.round((radius*2) * Math.sin(angle - (Math.PI/2)));
</span><span class='line'>  return {
</span><span class='line'>    x: x,
</span><span class='line'>    y: y
</span><span class='line'>  }
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>function getRandomInt(min, max) {
</span><span class='line'>  return Math.floor(Math.random() * (max - min)) + min;
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>function shuffleArray(array) {
</span><span class='line'>    for (var i = array.length - 1; i &gt; 0; i--) {
</span><span class='line'>        var j = Math.floor(Math.random() * (i + 1));
</span><span class='line'>        var temp = array[i];
</span><span class='line'>        array[i] = array[j];
</span><span class='line'>        array[j] = temp;
</span><span class='line'>    }
</span><span class='line'>    return array;
</span><span class='line'>}
</span></code></pre></td></tr></table></div></figure>


<p>Yes more setup. <code>getXYParticle</code> is a function I&rsquo;ve modified from the fireworks particle blog post I wrote. This essentially distributes a random number of particles around a circle. This is what we will use for the little particles that blow up.</p>

<p>The <code>getRandomInt</code> is pretty self explanatory, but it just returns a random number and we&rsquo;ll use it to create some variance.</p>

<p><code>shuffleArray</code> also just shuffles things in an array, we&rsquo;ll use this to achieve random color effects later.</p>

<h2>Blank Canvas</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>var ExplodingHearts = React.createClass({
</span><span class='line'>  getInitialState: function() {
</span><span class='line'>    return {
</span><span class='line'>      animation: new Animated.Value(0) 
</span><span class='line'>    };
</span><span class='line'>  },
</span><span class='line'>  explode: function() {
</span><span class='line'>    Animated.timing(this.state.animation, {
</span><span class='line'>      duration: 1500,
</span><span class='line'>      toValue: 28
</span><span class='line'>    }).start(() =&gt; {
</span><span class='line'>      this.state.animation.setValue(0);
</span><span class='line'>      this.forceUpdate();
</span><span class='line'>    }.bind(this));
</span><span class='line'>  },
</span><span class='line'>
</span><span class='line'>  render: function() {
</span><span class='line'>    return (
</span><span class='line'>      &lt;View style={styles.container}&gt;
</span><span class='line'>        &lt;TouchableWithoutFeedback onPress={this.explode} style={styles.container}&gt; 
</span><span class='line'>          &lt;View&gt;
</span><span class='line'>            &lt;Surface width={deviceWidth} height={deviceHeight}&gt;
</span><span class='line'>            &lt;/Surface&gt;
</span><span class='line'>          &lt;/View&gt;
</span><span class='line'>        &lt;/TouchableWithoutFeedback&gt;
</span><span class='line'>      &lt;/View&gt;
</span><span class='line'>    );
</span><span class='line'>  }
</span><span class='line'>});
</span></code></pre></td></tr></table></div></figure>


<p>We setup a blank canvas. We need to create our initial <code>animation</code> value so we just do a <code>new Animated.Value(0)</code> in our <code>getInitialState</code>.</p>

<p>We setup a <code>TouchableWithoutFeedback</code> for the ability to use <code>onPress</code> to trigger our animation. We then setup our <code>ART</code> <code>Surface</code> to fill the screen.</p>

<p>Why are we using ART for this? Well it&rsquo;ll make our rendering and animations very efficient, we could use a bunch of <code>Views</code> for this demo but on a large scale with lots of graphics work you should use <code>ART</code></p>

<p>Our <code>explode</code> function kicks off our animation and we do it over 1.5 seconds. We will animate to 28 because that is how many &ldquo;frames&rdquo; we have.</p>

<p>Don&rsquo;t worry about the callback, that&rsquo;s just to reset the animation when it is done, and also the <code>forceUpdate</code> re-renders so we get new random values on each subsequent trigger.</p>

<h2>Render A Heart</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;Surface width={deviceWidth} height={deviceHeight}&gt;
</span><span class='line'>    &lt;AnimatedShape
</span><span class='line'>      d={HEART_SVG}
</span><span class='line'>      x={0}
</span><span class='line'>      y={0}
</span><span class='line'>      scale={1}
</span><span class='line'>      fill={GRAY_HEART_COLOR}
</span><span class='line'>    /&gt;
</span><span class='line'>&lt;/Surface&gt;</span></code></pre></td></tr></table></div></figure>


<p>We just render a heart, pass in our SVG path, put it at the top left <code>0,0</code> coordinates. Scale is set to 1 and we fill it with our <code>GRAY_HEART_COLOR</code> we setup above.</p>

<h2>Talking Keyframes and Animations</h2>

<p>Before we dive in I want to explain what is about to happen. The original Twitter exploding has 28 frames. Our animation will start at <code>0</code>, and that is our default state. So we&rsquo;ll need to set everything up to default when we start <code>0</code> (initial render).</p>

<p>Then anytime from <code>1</code> to <code>28</code> we will need to design our values so that they produce the correct frame animation.</p>

<p><code>Animated</code> provides a way to interpolate. What that means is given a value, we want it to go through a formula and spit out another value. <code>Animated</code> does this via ranges, which can at times be a little inflexible and we have to hack around it&rsquo;s shortcomings to get desired effects.</p>

<p>All (well almost all) our animations will be interpolating from the single <code>this.state.animation</code> that we created earlier. This just makes it easy to comprehend and layout your animation frames. Because you can then specify that something happens at frame <code>10</code> instead of dividing <code>1/28</code> and say start at <code>0.03571428571</code>.</p>

<h2>Scale it up</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>render: function() {
</span><span class='line'>    var heart_scale = this.state.animation.interpolate({
</span><span class='line'>      inputRange: [0, .01, 6, 10, 12, 18, 28],
</span><span class='line'>      outputRange: [1, 0, .1, 1, 1.2, 1, 1],
</span><span class='line'>      extrapolate: 'clamp'
</span><span class='line'>    });
</span><span class='line'>
</span><span class='line'>    var heart_fill = this.state.animation.interpolate({
</span><span class='line'>      inputRange: [0, 2],
</span><span class='line'>      outputRange: [GRAY_HEART_COLOR, HEART_COLOR],
</span><span class='line'>      extrapolate: 'clamp'
</span><span class='line'>    })
</span><span class='line'>
</span><span class='line'>    var heart_x = heart_scale.interpolate({
</span><span class='line'>      inputRange: [0, 1],
</span><span class='line'>      outputRange: [90, 0],
</span><span class='line'>    })
</span><span class='line'>
</span><span class='line'>    var heart_y = heart_scale.interpolate({
</span><span class='line'>      inputRange: [0, 1],
</span><span class='line'>      outputRange: [75, 0],
</span><span class='line'>    })
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<p>Alright there is a lot going on. Lets break it down.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>var heart_scale = this.state.animation.interpolate({
</span><span class='line'>  inputRange: [0, .01, 6, 10, 12, 18],
</span><span class='line'>  outputRange: [1, 0, .1, 1, 1.2, 1],
</span><span class='line'>  extrapolate: 'clamp'
</span><span class='line'>});</span></code></pre></td></tr></table></div></figure>


<p>We <code>interpolate</code> on the <code>this.state.animation</code> and give it an <code>inputRange</code> and <code>outputRange</code> array. These must have the same amount of array values.</p>

<p>I talked about some weird things with <code>Animated</code> and setting up defaults. Well <code>inputRange: [0, .01], outputRange: [1, 0]</code> is the first example.</p>

<p>At 0 we want it to be fully scaled, so output at 1. However as soon as the animation is triggered we want it to be at 0. If we only specified <code>0, 1</code> as the inputRange, it would have the heart scale down from 1 to 0. So specifying the scale inputRange at <code>0 =&gt; .01</code> means it&rsquo;ll basically disappear.</p>

<p>It&rsquo;s essentially a way to make an animation not a whole frame, and or happen virtually immediately.</p>

<p>There is a slight spring in the heart. So from frame <code>10</code> to <code>12</code> it will spring up fast to <code>1.2</code> scale, and then slowly fall back from <code>1.2</code> to <code>1</code> from frames <code>12</code> to <code>18</code>.</p>

<p><code>extrapolate: 'clamp'</code> IS EXTREMELY IMPORTANT HERE. If we want it to just stay the same once it hits frame 18 and not do anything else until the end we must add the clamp. Otherwise it will continue to animate at the current stepping value, so it would scale down below 1 and we don&rsquo;t want that.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>var heart_fill = this.state.animation.interpolate({
</span><span class='line'>  inputRange: [0, 2],
</span><span class='line'>  outputRange: [GRAY_HEART_COLOR, HEART_COLOR],
</span><span class='line'>  extrapolate: 'clamp'
</span><span class='line'>})</span></code></pre></td></tr></table></div></figure>


<p>We have the heart hidden after frame <code>1</code>, so what this animation says is at <code>0</code> , inital render, be gray. Anytime from frame 2 and out be red, and always be read.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>    var heart_x = heart_scale.interpolate({
</span><span class='line'>      inputRange: [0, 1],
</span><span class='line'>      outputRange: [90, 0],
</span><span class='line'>    })
</span><span class='line'>
</span><span class='line'>    var heart_y = heart_scale.interpolate({
</span><span class='line'>      inputRange: [0, 1],
</span><span class='line'>      outputRange: [75, 0],
</span><span class='line'>    })</span></code></pre></td></tr></table></div></figure>


<p>This is the one part where we don&rsquo;t want to base things on the key frame. Because there is no <code>transform-origin</code> like there is in CSS, the default scale will scale out to the top left.
That isn&rsquo;t what we want.</p>

<p>So to scale out to the center we need to animate the x/y while scaling, so we interpolate off the interpolate for scale. Remember we default our scale up above to 1, so we are reversing stuff here saying when the scale is scaling down from 0 to 1 adjust to 90 for x and 75 for y.</p>

<p>The 90/75 just has to deal with the current surface center.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>return (
</span><span class='line'>    &lt;Surface width={deviceWidth} height={deviceHeight}&gt;
</span><span class='line'>        &lt;AnimatedShape
</span><span class='line'>          d={HEART_SVG}
</span><span class='line'>          x={heart_x}
</span><span class='line'>          y={heart_y}
</span><span class='line'>          scale={heart_scale}
</span><span class='line'>          fill={heart_fill}
</span><span class='line'>        /&gt;
</span><span class='line'>    &lt;/Surface&gt;
</span><span class='line'>
</span><span class='line'>)</span></code></pre></td></tr></table></div></figure>


<p>We use our <code>AnimatedShape</code> and pass in the animated values we created. A lot of things I explain up above are the basic concepts through out this tutorial so I wont&#8217; explain them again.</p>

<h2>Add a Circle</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>var AnimatedCircle = React.createClass({displayName: "Circle",
</span><span class='line'>  render: function() {
</span><span class='line'>    var radius = this.props.radius;
</span><span class='line'>    var path = Path().moveTo(0, -radius)
</span><span class='line'>        .arc(0, radius * 2, radius)
</span><span class='line'>        .arc(0, radius * -2, radius)
</span><span class='line'>        .close();
</span><span class='line'>    return React.createElement(AnimatedShape, React.__spread({},  this.props, {d: path}));
</span><span class='line'>  }
</span><span class='line'>});</span></code></pre></td></tr></table></div></figure>


<p>This is taken from previous firework demos and default ReactART, but I&rsquo;ve converted it to use our <code>AnimatedShape</code> we created up above.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;Surface width={deviceWidth} height={deviceHeight}&gt;
</span><span class='line'>  &lt;Group x={100} y={200}&gt;
</span><span class='line'>    &lt;AnimatedShape
</span><span class='line'>      d={HEART_SVG}
</span><span class='line'>      x={heart_x}
</span><span class='line'>      y={heart_y}
</span><span class='line'>      scale={heart_scale}
</span><span class='line'>      fill={heart_fill}
</span><span class='line'>    /&gt;
</span><span class='line'>    &lt;AnimatedCircle
</span><span class='line'>      x={90}
</span><span class='line'>      y={75}
</span><span class='line'>      radius={150}
</span><span class='line'>      scale={1}
</span><span class='line'>      strokeWidth={3}
</span><span class='line'>      fill="#000"
</span><span class='line'>      opacity={1}
</span><span class='line'>    /&gt;
</span><span class='line'>  &lt;/Group&gt;
</span><span class='line'>&lt;/Surface&gt;</span></code></pre></td></tr></table></div></figure>


<p>We render an arbitrary circle, at <code>90</code> and <code>75</code> which is the center of our current surface.</p>

<h2>Blow that Circle Up</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>var circle_scale = this.state.animation.interpolate({
</span><span class='line'>  inputRange: [0, 1, 4],
</span><span class='line'>  outputRange: [0, .3, 1],
</span><span class='line'>  extrapolate: 'clamp'
</span><span class='line'>});
</span><span class='line'>
</span><span class='line'>var circle_stroke_width = this.state.animation.interpolate({
</span><span class='line'>  inputRange: [0, 5.99, 6, 7, 10],
</span><span class='line'>  outputRange: [0, 0, 15, 8, 0],
</span><span class='line'>  extrapolate: 'clamp'
</span><span class='line'>});
</span><span class='line'>
</span><span class='line'>var circle_fill_colors = this.state.animation.interpolate({
</span><span class='line'>  inputRange: [1, 2, 3, 4, 4.99, 5],
</span><span class='line'>  outputRange: FILL_COLORS,
</span><span class='line'>  extrapolate: 'clamp'
</span><span class='line'>})
</span><span class='line'>
</span><span class='line'>var circle_opacity = this.state.animation.interpolate({
</span><span class='line'>  inputRange: [1,9.99, 10],
</span><span class='line'>  outputRange: [1, 1, 0],
</span><span class='line'>  extrapolate: 'clamp'
</span><span class='line'>})</span></code></pre></td></tr></table></div></figure>


<p>Alright so we scale up, based on the image we scale up to <code>.3</code> in a single frame, then over the course of 3 frames we scale up our circle to a scale of 1.</p>

<p>Our stroke width also changes however we won&rsquo;t always render it. We only need it for a few frames starting at frame 6. So we will specify that the stroke width stays at <code>0</code> from <code>0</code> to frame <code>5.99</code>.</p>

<p>Then over the course of 1 frame it goes to 15 which I chose at random, down to 8, and eventually 0 by frame 10.</p>

<p>We specify a range of colors in the array I talked about in setup. The weird part is that we have to specify the final color a few times before setting the fill to transparent. The reason is that if we specify just the transparent color the purple color will fade out to transparent but we want it to completely disappear and just show the stroke.</p>

<p>So we have to coordinate stroke frames appearing with the fill color disappearing.</p>

<p>Finally our opacity stays 1 until frame 9.99 (the end of our circle stroke) then we kill it on frame 10.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;AnimatedCircle
</span><span class='line'>  x={89}
</span><span class='line'>  y={75}
</span><span class='line'>  radius={150}
</span><span class='line'>  scale={circle_scale}
</span><span class='line'>  strokeWidth={circle_stroke_width}
</span><span class='line'>  stroke={FILL_COLORS[2]}
</span><span class='line'>  fill={circle_fill_colors}
</span><span class='line'>  opacity={circle_opacity}
</span><span class='line'>/&gt;</span></code></pre></td></tr></table></div></figure>


<p>We put those in and because our stroke color is always the same we just reference our fill colors.</p>

<h2>Bunch of Circles Blowing Up</h2>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;Surface width={deviceWidth} height={deviceHeight}&gt;
</span><span class='line'>  &lt;Group x={100} y={200}&gt;
</span><span class='line'>    &lt;AnimatedShape
</span><span class='line'>      d={HEART_SVG}
</span><span class='line'>      x={heart_x}
</span><span class='line'>      y={heart_y}
</span><span class='line'>      scale={heart_scale}
</span><span class='line'>      fill={heart_fill}
</span><span class='line'>    /&gt;
</span><span class='line'>    &lt;AnimatedCircle
</span><span class='line'>      x={90}
</span><span class='line'>      y={75}
</span><span class='line'>      radius={150}
</span><span class='line'>      scale={circle_scale}
</span><span class='line'>      strokeWidth={circle_stroke_width}
</span><span class='line'>      stroke={FILL_COLORS[2]}
</span><span class='line'>      fill={circle_fill_colors}
</span><span class='line'>      opacity={circle_opacity}
</span><span class='line'>    /&gt;
</span><span class='line'>
</span><span class='line'>    {this.getSmallExplosions(150, {x:90, y:75})}
</span><span class='line'>  &lt;/Group&gt;
</span><span class='line'>&lt;/Surface&gt;</span></code></pre></td></tr></table></div></figure>


<p>Alright now we setup our final piece. Calling <code>getSmallExplosions</code> with some data. In our case the radius of our circle and the central coordinates.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>  getSmallExplosions: function(radius, offset) {
</span><span class='line'>    return [0,1,2,3,4,5,6].map((v, i, t) =&gt; {
</span><span class='line'>
</span><span class='line'>      var scaleOut = this.state.animation.interpolate({
</span><span class='line'>        inputRange: [0, 5.99, 6, 13.99, 14, 21],
</span><span class='line'>        outputRange: [0, 0, 1, 1, 1, 0],
</span><span class='line'>        extrapolate: 'clamp'
</span><span class='line'>      });
</span><span class='line'>
</span><span class='line'>      var moveUp = this.state.animation.interpolate({
</span><span class='line'>        inputRange: [0, 5.99, 14],
</span><span class='line'>        outputRange: [0, 0, -15],
</span><span class='line'>        extrapolate: 'clamp'
</span><span class='line'>      });
</span><span class='line'>
</span><span class='line'>      var moveDown = this.state.animation.interpolate({
</span><span class='line'>        inputRange: [0, 5.99, 14],
</span><span class='line'>        outputRange: [0, 0, 15],
</span><span class='line'>        extrapolate: 'clamp'
</span><span class='line'>      });
</span><span class='line'>
</span><span class='line'>      var color_top_particle = this.state.animation.interpolate({
</span><span class='line'>        inputRange: [6, 8, 10, 12, 17, 21],
</span><span class='line'>        outputRange: shuffleArray(PARTICLE_COLORS)
</span><span class='line'>      })
</span><span class='line'>
</span><span class='line'>      var color_bottom_particle = this.state.animation.interpolate({
</span><span class='line'>        inputRange: [6, 8, 10, 12, 17, 21],
</span><span class='line'>        outputRange: shuffleArray(PARTICLE_COLORS)
</span><span class='line'>      })
</span><span class='line'>
</span><span class='line'>      var position = getXYParticle(7, i, radius)
</span><span class='line'>
</span><span class='line'>      return (
</span><span class='line'>        &lt;Group 
</span><span class='line'>          x={position.x + offset.x } 
</span><span class='line'>          y={position.y + offset.y} 
</span><span class='line'>          rotation={getRandomInt(0, 40) * i}
</span><span class='line'>        &gt;
</span><span class='line'>          &lt;AnimatedCircle 
</span><span class='line'>            x={moveUp}
</span><span class='line'>            y={moveUp}
</span><span class='line'>            radius={15} 
</span><span class='line'>            scale={scaleOut} 
</span><span class='line'>            fill={color_top_particle} 
</span><span class='line'>          /&gt;
</span><span class='line'>          &lt;AnimatedCircle 
</span><span class='line'>            x={moveDown}
</span><span class='line'>            y={moveDown}
</span><span class='line'>            radius={8} 
</span><span class='line'>            scale={scaleOut} 
</span><span class='line'>            fill={color_bottom_particle} 
</span><span class='line'>          /&gt;
</span><span class='line'>        &lt;/Group&gt;
</span><span class='line'>      )
</span><span class='line'>    }, this)
</span><span class='line'>  },</span></code></pre></td></tr></table></div></figure>


<p>Not going to explain this one too indepth or I&rsquo;ll keep repeating myself. We create a bunch of animations for each particle but add some randomness into the mix. We call <code>shuffleArray</code> on our <code>PARTICLE_COLORS</code> so over the course of the frames it is active it&rsquo;ll animate to random colors for each particle.</p>

<p>Also we add a bit of <code>rotation</code> to the group, so when we animate the particles up/down they&rsquo;ll go in all different directions.</p>

<h2>Done</h2>

<p>Now you too can add a new interaction that all of your users will despise! No this isn&rsquo;t a perfect replica of the the Twiter animation because I added color variance and some random rotation to the small exploding/shrinking circles.</p>

<p><img src="http://i.imgur.com/lMOxqIL.gif" title="That is hot" ></p>

<h3>Interactive Demo at <a href="https://rnplay.org/apps/nJjHdw">https://rnplay.org/apps/nJjHdw</a></h3>

<p>I&rsquo;m not posting the full code, this is a long one. Just check it out on RNPlay.</p>
</div>
        
	</div>
	<div>
    	


		



  
		
			Tagged under
		
    <a class='category' href='/blog/categories/animations/'>animations</a>, <a class='category' href='/blog/categories/exploding/'>exploding</a>, <a class='category' href='/blog/categories/heart/'>heart</a>, <a class='category' href='/blog/categories/react/'>react</a>, <a class='category' href='/blog/categories/react-art/'>react-art</a>, <a class='category' href='/blog/categories/react-native/'>react-native</a>, <a class='category' href='/blog/categories/twitter/'>twitter</a>
	


    	
	</div>
	
</article>
<!-- END OF _includes/article.html -->


<footer style="margin-top: 10px;">
    <div id="post-author">
	<div class="post-author-content" style="width: 70%; display: inline-block;">
		<p style="font-size: 16px;">
			If you ever want further explanation, want to see a particular type of tutorial, or to contact me for whatever reason you can drop me a line on twitter <a href="http://twitter.com/browniefed">@browniefed</a> or email me at <a href="mailto:browniefed@gmail.com">browniefed@gmail.com</a>
		</p>
	</div>
</div>
</footer>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>


<!-- END OF _/layouts/post.html -->

		
			<footer>
				Copyright &copy; 2017

	Jason Brown


			</footer>
			
		</div> <!-- // .wrap -->
          

<script type="text/javascript">
      var disqus_shortname = 'browniefedblog';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://browniefed.com/blog/react-native-how-to-create-twitter-exploding-hearts/';
        var disqus_url = 'http://browniefed.com/blog/react-native-how-to-create-twitter-exploding-hearts/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


	</body>
	<script>
		$(document).ready(function() {
			// Make images center
			$('p:has(img)').css('text-align', 'center');
			
			// Add the image's title attribute as a caption
			$('p:has(img)').append(function () {
				return '<div class="caption">' + $('img', this).attr('title') + '</div>';
			});
			
			// Prettify code
			$('code').addClass('prettyprint');
			$('pre code').addClass('linenums');
			
			// Copy to clipboard with button
			$('pre:has(code)').prepend(function(){
				return '<div class="clip-btn">copy to clipboard</div>';
			});
			$('.clip-btn').zclip({
				path:'/js/ZeroClipboard.swf',
				copy: function() {
                    return $(this).next('code').text().split("\n").join("\r\n")
                },
				afterCopy: function(){
					$(this).replaceWith('<div class="clip-btn">copied!');
				}
			});
		});
	</script>
    

<script type="text/javascript">
      var disqus_shortname = 'browniefedblog';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://browniefed.com/blog/react-native-how-to-create-twitter-exploding-hearts/';
        var disqus_url = 'http://browniefed.com/blog/react-native-how-to-create-twitter-exploding-hearts/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


</html>
<!-- END OF _layouts/default.html -->
